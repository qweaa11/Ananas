<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="KKH">


	<select id="findBookBysidebar" parameterType="HashMap"
		resultType="com.spring.bookmanage.book.KKHmodel.KKHBookVO">
		select distinct substr(A.bookid,1, instr(A.bookid,'-',1,2)-1 ) as
		bookid, A.idx, title, author, status, agecode
		,gcode_fk, gname,ncode_fk, nname,lcode_fk, lname,fcode_fk, fname,ccode_fk, cname
		,libcode_fk, libname ,pubcode_fk, pubname
		from book A join genre G on A.gcode_fk = G.gcode join nation N on
		A.ncode_fk = N.ncode join language L on A.lcode_fk = L.lcode
		join field F on A.fcode_fk = F.fcode join category C on A.ccode_fk =
		C.ccode join library LIB on A.libcode_fk = LIB.libcode join publisher
		P on A.pubcode_fk = P.pubcode
		where status != 4
		
		<if test="LIBRARY != '' or LIBRARY != null">
			and libcode_fk in (${LIBRARY})
			
		</if>
		<!-- <if test="CATEGORY != '' or CATEGORY != null">
			and ccode_fk in
			<foreach item="cate" index="i" collection="CATEGORY" open="('"
				separator="','" close="')">
				#{cate[i]}
			</foreach>
		</if>
		<if test="LANGUAGE != '' or LANGUAGE != null">
			and lcode_fk in 
			<foreach item="lan" index="i" collection="LANGUAGE" open="('"
				separator="','" close="')">
				#{lan[i]}
			</foreach>
		</if>
		<if test="FIELD != '' or FIELD != null">
			and fcode_fk in 
			<foreach item="field" index="i" collection="FIELD" open="('"
				separator="','" close="')">
				#{field[i]}
			</foreach>
		</if> -->
		order by ${SORT}
	</select>



</mapper>